import './App.css'
import Home from './Components/Home'
import Login from './Components/Login'
import { BrowserRouter as Router, Route, Routes } from "react-router-dom"
import Register from './Components/Register'
import { useEffect, useState } from 'react'
import LandingPage from './Components/Main/LandingPage'

function App() {
  const [email, setEmail] = useState("");
  const [isLoggedIn, setIsLoggedIn] = useState(false);

  useEffect(() => {
    const checkLoggedIn = async () => {
      try {
        const res = await fetch("http://127.0.0.1:5000/is-login", {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: {},
        })

        const res_data = await res.json();
        if(res_data.status === 201){
          setIsLoggedIn(true);
        }
        else{
          setIsLoggedIn(false);
        }
      } catch (error) {
        console.log(error)
        setIsLoggedIn(false);
      }
    }

    checkLoggedIn();
  }, [])

  return (
    <>
      <Router>
        <Routes>
          <Route exact path="/" element={<Home setEmail={setEmail} email={email} isLoggedIn={isLoggedIn} />} />
          <Route exact path="/login" element={<Login setIsLoggedIn={setIsLoggedIn}/>} />
          <Route exact path="/register" element={<Register email={email} />} />
          <Route exact path="/in" element={<LandingPage setIsLoggedIn={setIsLoggedIn}/>} />
        </Routes>
      </Router>
    </>
  )
}

export default App
