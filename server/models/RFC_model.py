from sklearn.ensemble import RandomForestClassifier
from Feature_Extraction import X_tsne, y
from sklearn.model_selection import train_test_split
from RFC_Model_def import rf_classifier
import joblib


X_train, X_test, y_train_encoded, y_test_encoded = train_test_split(X_tsne, y.values, test_size=0.2, random_state=42)

rf_classifier = RandomForestClassifier(n_estimators=10, random_state=42)
rf_classifier.fit(X_train, y_train_encoded)

joblib.dump(rf_classifier, 'rfc_model.pkl')


